
################################################################################
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
library(BiocManager)
BiocManager::install("Rgraphviz")
library(Rgraphviz)
BiocManager::install("bnlearn")
library(bnlearn)

install.packages("bnlearn")
library(bnlearn)
rm(list=ls())
################################################################################

################################################################################
# DAG 1.

lv = c("1", "2", "3", "4")
cptA = array(c(0.5, 0.2,0.1,0.2), dim = 4, dimnames = list(A = lv));cptA

cptB = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(B = lv));cptB

cptC = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.3,0.3,0.2,  
               0.75,0.2,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.6,0.15,0.05,  0.1,0.4,0.3,0.2,  0.0,0.2,0.7,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.4,0.5,  0.0,0.0,0.1,0.9), 
             dim = c(4, 4, 4),
             dimnames = list(C = lv, A = lv, B = lv) ); cptC

cptD = array(c(0.7,0.2,0.1,0.0,  0.8,0.1,0.1,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.9,0.1), 
             dim = c(4,4), dimnames = list(D = lv, B = lv)); cptD

cptE = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.5,0.3,0.2,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.2,0.1,  0.1,0.35,0.35,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.3,0.5,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.75,0.15,  0.0,0.1,0.5,0.4,  0.0,0.0,0.3,0.7), 
             dim = c(4, 4, 4),
             dimnames = list(E = lv, A = lv, B = lv) ); cptE

net1 = model2network("[A][B][D|B][C|A:B][E|A:B]")
graphviz.plot(net1)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE)
bn1 = custom.fit(net1, cpt, ordinal = c("A", "B", "C", "D", "E"))
################################################################################

################################################################################
# DAG 2.

lv = c("1", "2", "3", "4")
cptA = array(c(0.5, 0.2,0.1,0.2), dim = 4, dimnames = list(A = lv));cptA

cptB = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(B = lv));cptB

cptC = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.3,0.3,0.2,  
               0.75,0.2,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.6,0.15,0.05,  0.1,0.4,0.3,0.2,  0.0,0.2,0.7,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.4,0.5,  0.0,0.0,0.1,0.9), 
             dim = c(4, 4, 4),
             dimnames = list(C = lv, A = lv, B = lv) ); cptC

cptD = array(c(0.7,0.2,0.1,0.0,  0.8,0.1,0.1,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.9,0.1), 
             dim = c(4,4), dimnames = list(D = lv, B = lv)); cptD

cptE = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.5,0.3,0.2,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.2,0.1,  0.1,0.35,0.35,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.3,0.5,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.75,0.15,  0.0,0.1,0.5,0.4,  0.0,0.0,0.3,0.7), 
             dim = c(4, 4, 4),
             dimnames = list(E = lv, A = lv, B = lv) ); cptE

cptH = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(H = lv, D = lv)); cptH

cptF = array(c(0.1, 0.8,0.05,0.05), dim = 4, dimnames = list(F = lv)); cptF

cptG = array(c(0.1, 0.2,0.35,0.35), dim = 4, dimnames = list(G = lv)); cptG

cptI = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9), 
             dim = c(4,4,4), dimnames = list(I = lv, F = lv, H = lv)); cptI

cptK = array(c(0.3,0.6,0.1,0.0,  0.5,0.4,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(K = lv, G = lv)); cptK

net2 = model2network("[A][B][C|A:B][D|B][E|A:B][H|D][F][G][I|F:H][K|G]")
graphviz.plot(net2)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, F = cptF, G = cptG,
           H = cptH, I = cptI, K = cptK)
bn2 = custom.fit(net2, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                        "I", "K"))
################################################################################

################################################################################
# DAG 3.

lv = c("1", "2", "3", "4")
cptA = array(c(0.5, 0.2,0.1,0.2), dim = 4, dimnames = list(A = lv));cptA

cptB = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(B = lv));cptB

cptC = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.3,0.3,0.2,  
               0.75,0.2,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.6,0.15,0.05,  0.1,0.4,0.3,0.2,  0.0,0.2,0.7,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.4,0.5,  0.0,0.0,0.1,0.9), 
             dim = c(4, 4, 4),
             dimnames = list(C = lv, A = lv, B = lv) ); cptC

cptD = array(c(0.7,0.2,0.1,0.0,  0.8,0.1,0.1,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.9,0.1), 
             dim = c(4,4), dimnames = list(D = lv, B = lv)); cptD

cptE = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.5,0.3,0.2,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.2,0.1,  0.1,0.35,0.35,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.3,0.5,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.75,0.15,  0.0,0.1,0.5,0.4,  0.0,0.0,0.3,0.7), 
             dim = c(4, 4, 4),
             dimnames = list(E = lv, A = lv, B = lv) ); cptE

cptH = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(H = lv, D = lv)); cptH

cptF = array(c(0.1, 0.8,0.05,0.05), dim = 4, dimnames = list(F = lv)); cptF

cptG = array(c(0.1, 0.2,0.35,0.35), dim = 4, dimnames = list(G = lv)); cptG

cptI = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9), 
             dim = c(4,4,4), dimnames = list(I = lv, F = lv, H = lv)); cptI

cptJ = array(c(0.25, 0.35,0.15,0.25), dim = 4, dimnames = list(J = lv)); cptJ

cptK = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.85,0.1,0.05,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.45,0.45,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.35,0.5,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.4,0.2,0.1,  0.2,0.55,0.25,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.15,0.15,0.6,0.1,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.3,0.3,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.2,0.6,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.1,0.1,0.8), 
             dim = c(4,4,4,4), dimnames = list(K = lv, F = lv, G = lv, H = lv)); cptK

net3 = model2network("[A][B][C|A:B][D|B][E|A:B][F][G][H|D][I|F:H][J][K|F:G:H]")
graphviz.plot(net3)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, F = cptF, G = cptG,
           H = cptH, I = cptI, J = cptJ, K = cptK)
bn3 = custom.fit(net3, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                        "I", "J", "K"))
################################################################################

################################################################################
# DAG 4.

lv = c("1", "2", "3", "4")
cptA = array(c(0.5, 0.2,0.1,0.2), dim = 4, dimnames = list(A = lv));cptA

cptB = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(B = lv));cptB

cptC = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.3,0.3,0.2,  
               0.75,0.2,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.6,0.15,0.05,  0.1,0.4,0.3,0.2,  0.0,0.2,0.7,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.4,0.5,  0.0,0.0,0.1,0.9), 
             dim = c(4, 4, 4),
             dimnames = list(C = lv, A = lv, B = lv) ); cptC

cptD = array(c(0.7,0.2,0.1,0.0,  0.8,0.1,0.1,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.9,0.1), 
             dim = c(4,4), dimnames = list(D = lv, B = lv)); cptD

cptE = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.5,0.3,0.2,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.2,0.1,  0.1,0.35,0.35,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.3,0.5,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.75,0.15,  0.0,0.1,0.5,0.4,  0.0,0.0,0.3,0.7), 
             dim = c(4, 4, 4),
             dimnames = list(E = lv, A = lv, B = lv) ); cptE

cptF = array(c(0.1, 0.8,0.05,0.05), dim = 4, dimnames = list(F = lv)); cptF

cptG = array(c(0.9,0.05,0.05,0.0,  0.8,0.1,0.1,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.05,0.95), 
             dim = c(4,4), dimnames = list(G = lv, N = lv)); cptG

cptH = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(H = lv, D = lv)); cptH

cptI = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9), 
             dim = c(4,4,4), dimnames = list(I = lv, F = lv, H = lv)); cptI

cptJ = array(c(0.25, 0.35,0.15,0.25), dim = 4, dimnames = list(J = lv)); cptJ

cptK = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.85,0.1,0.05,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.45,0.45,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.35,0.5,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.4,0.2,0.1,  0.2,0.55,0.25,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.15,0.15,0.6,0.1,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.3,0.3,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.2,0.6,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.1,0.1,0.8), 
             dim = c(4,4,4,4), dimnames = list(K = lv, F = lv, G = lv, H = lv)); cptK

cptL = array(c(0.25, 0.45,0.15,0.15), dim = 4, dimnames = list(L = lv)); cptL

cptM = array(c(0.15, 0.25,0.35,0.25), dim = 4, dimnames = list(M = lv)); cptM

cptN = array(c(0.8,0.2,0.0,0.0,  0.3,0.7,0.0,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(N = lv, A = lv)); cptN

cptO = array(c(0.95,0.05,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.9,0.1,0.0,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.55,0.35,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.3,0.55,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.3,0.3,0.1,  0.2,0.45,0.35,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.1,0.15,0.7,0.05,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.35,0.25,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.1,0.7,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.05,0.1,0.85), 
             dim = c(4,4,4,4), dimnames = list(O = lv, L = lv, M = lv, N = lv)); cptO

net4 = model2network("[A][B][C|A:B][D|B][E|A:B][F][G|N][H|D][I|F:H][J][K|F:G:H][L][M][N|A][O|L:M:N]")
graphviz.plot(net4)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, F = cptF, G = cptG,
           H = cptH, I = cptI, J = cptJ, K = cptK, L = cptL, M = cptM, N = cptN,
           O = cptO)
bn4 = custom.fit(net4, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                        "I", "J", "K", "L", "M", "N", "O"))
################################################################################

################################################################################
# DAG 5.

lv = c("1", "2", "3", "4")
cptA = array(c(0.5, 0.2,0.1,0.2), dim = 4, dimnames = list(A = lv));cptA

cptB = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(B = lv));cptB

cptC = array(c(0.9,0.1,0.0,0.0,  0.2,0.8,0.0,0.0,  0.0,0.1,0.8,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(C = lv, A = lv) ); cptC

cptD = array(c(0.7,0.2,0.1,0.0,  0.4,0.5,0.1,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.4,0.6), 
             dim = c(4,4), dimnames = list(D = lv, B = lv)); cptD

cptE = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.5,0.3,0.2,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.2,0.1,  0.1,0.35,0.35,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.3,0.5,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.75,0.15,  0.0,0.1,0.5,0.4,  0.0,0.0,0.3,0.7), 
             dim = c(4, 4, 4),
             dimnames = list(E = lv, A = lv, B = lv) ); cptE

cptF = array(c(0.1, 0.8,0.05,0.05), dim = 4, dimnames = list(F = lv)); cptF

cptG = array(c(0.9,0.05,0.05,0.0,  0.8,0.1,0.1,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.05,0.95), 
             dim = c(4,4), dimnames = list(G = lv, N = lv)); cptG

cptH = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(H = lv, D = lv)); cptH

cptI = array(c(0.9,0.1,0.0,0.0,  0.3,0.6,0.1,0.0,  0.1,0.05,0.75,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(I = lv, F = lv)); cptI

cptJ = array(c(0.25, 0.35,0.15,0.25), dim = 4, dimnames = list(J = lv)); cptJ

cptK = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.85,0.1,0.05,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.45,0.45,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.35,0.5,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.4,0.2,0.1,  0.2,0.55,0.25,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.15,0.15,0.6,0.1,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.3,0.3,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.2,0.6,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.1,0.1,0.8), 
             dim = c(4,4,4,4), dimnames = list(K = lv, F = lv, G = lv, H = lv)); cptK

cptL = array(c(0.25, 0.45,0.15,0.15), dim = 4, dimnames = list(L = lv)); cptL

cptM = array(c(0.15, 0.25,0.35,0.25), dim = 4, dimnames = list(M = lv)); cptM

cptN = array(c(0.8,0.2,0.0,0.0,  0.3,0.7,0.0,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(N = lv, A = lv)); cptN

cptO = array(c(0.95,0.05,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.9,0.1,0.0,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.55,0.35,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.3,0.55,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.3,0.3,0.1,  0.2,0.45,0.35,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.1,0.15,0.7,0.05,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.35,0.25,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.1,0.7,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.05,0.1,0.85), 
             dim = c(4,4,4,4), dimnames = list(O = lv, L = lv, M = lv, N = lv)); cptO

cptP = array(c(0.15, 0.35,0.35,0.15), dim = 4, dimnames = list(P = lv)); cptP

cptQ = array(c(0.05, 0.25,0.45,0.25), dim = 4, dimnames = list(Q = lv)); cptQ

cptR = array(c(0.6,0.3,0.1,0.0,  0.5,0.5,0.0,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.2,0.8), 
             dim = c(4,4), dimnames = list(R = lv, Q = lv)); cptR

cptS = array(c(0.15, 0.25,0.35,0.25), dim = 4, dimnames = list(S = lv)); cptS

cptT = array(c(0.8,0.1,0.1,0.0,  0.3,0.6,0.1,0.0,  0.3,0.2,0.4,0.1,  0.2,0.2,0.4,0.2,
               0.75,0.2,0.05,0.0,  0.3,0.6,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.1,0.8,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.3,0.6,  0.0,0.0,0.05,0.95),
             dim = c(4,4,4), dimnames = list(T = lv, Q = lv, S = lv)); cptT

cptU = array(c(0.35, 0.25,0.3,0.1), dim = 4, dimnames = list(U = lv)); cptU

net5 = model2network("[A][B][C|A][D|B][E|A:B][F][G|N][H|D][I|F][J][K|F:G:H][L][M][N|A][O|L:M:N][P][Q][R|Q][S][T|Q:S][U]")
graphviz.plot(net5)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, F = cptF, G = cptG,
           H = cptH, I = cptI, J = cptJ, K = cptK, L = cptL, M = cptM, N = cptN,
           O = cptO, P = cptP, Q = cptQ, R = cptR, S = cptS, T = cptT, U = cptU)
bn5 = custom.fit(net5, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                        "I", "J", "K", "L", "M", "N", "O", "P",
                                        "Q", "R", "S", "T", "U" ))
################################################################################

################################################################################
# DAG 6.

lv = c("1", "2", "3", "4")
cptA = array(c(0.5, 0.2,0.1,0.2), dim = 4, dimnames = list(A = lv));cptA

cptB = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(B = lv));cptB

cptC = array(c(0.9,0.1,0.0,0.0,  0.2,0.8,0.0,0.0,  0.0,0.1,0.8,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(C = lv, A = lv) ); cptC

cptD = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.5,0.3,0.2,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.2,0.1,  0.1,0.35,0.35,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.3,0.5,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.75,0.15,  0.0,0.1,0.5,0.4,  0.0,0.0,0.3,0.7), 
             dim = c(4, 4, 4),
             dimnames = list(D = lv, A = lv, B = lv) ); cptD

cptE = array(c(0.7,0.2,0.1,0.0,  0.4,0.5,0.1,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.4,0.6), 
             dim = c(4,4), dimnames = list(E = lv, B = lv)); cptE

cptF = array(c(0.1, 0.6,0.25,0.05), dim = 4, dimnames = list(F = lv)); cptF

cptG = array(c(0.9,0.05,0.05,0.0,  0.8,0.1,0.1,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.05,0.95), 
             dim = c(4,4), dimnames = list(G = lv, N = lv)); cptG

cptH = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.1,0.5,0.3,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(H = lv, D = lv)); cptH

cptI = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9),
             dim = c(4,4,4), dimnames = list(I = lv, F = lv, H = lv)); cptI

cptJ = array(c(0.25, 0.35,0.15,0.25), dim = 4, dimnames = list(J = lv)); cptJ

cptK = array(c(0.9,0.1,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.85,0.1,0.05,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.45,0.45,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.35,0.5,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.4,0.2,0.1,  0.2,0.55,0.25,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.15,0.15,0.6,0.1,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.3,0.3,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.2,0.6,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.1,0.1,0.8), 
             dim = c(4,4,4,4), dimnames = list(K = lv, F = lv, G = lv, H = lv)); cptK

cptL = array(c(0.25, 0.45,0.15,0.15), dim = 4, dimnames = list(L = lv)); cptL

cptM = array(c(0.15, 0.25,0.35,0.25), dim = 4, dimnames = list(M = lv)); cptM

cptN = array(c(0.1, 0.2,0.5,0.2), dim = 4, dimnames = list(N = lv)); cptN

cptO = array(c(0.95,0.05,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.9,0.1,0.0,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.55,0.35,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.3,0.55,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.3,0.3,0.1,  0.2,0.45,0.35,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.1,0.15,0.7,0.05,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.35,0.25,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.1,0.7,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.05,0.1,0.85), 
             dim = c(4,4,4,4), dimnames = list(O = lv, L = lv, M = lv, N = lv)); cptO

cptP = array(c(0.15, 0.35,0.35,0.15), dim = 4, dimnames = list(P = lv)); cptP

cptQ = array(c(0.05, 0.25,0.45,0.25), dim = 4, dimnames = list(Q = lv)); cptQ

cptR = array(c(0.6,0.3,0.1,0.0,  0.5,0.5,0.0,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.2,0.8), 
             dim = c(4,4), dimnames = list(R = lv, Q = lv)); cptR

cptS = array(c(0.55, 0.25,0.15,0.05), dim = 4, dimnames = list(S = lv)); cptS

cptT = array(c(0.8,0.1,0.1,0.0,  0.3,0.6,0.1,0.0,  0.3,0.2,0.4,0.1,  0.2,0.2,0.4,0.2,
               0.75,0.2,0.05,0.0,  0.3,0.6,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.1,0.8,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.3,0.6,  0.0,0.0,0.05,0.95),
             dim = c(4,4,4), dimnames = list(T = lv, Q = lv, S = lv)); cptT

cptU = array(c(0.35, 0.25,0.3,0.1), dim = 4, dimnames = list(U = lv)); cptU

cptV = array(c(0.95,0.05,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.9,0.1,0.0,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.55,0.35,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.3,0.55,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.3,0.3,0.1,  0.2,0.45,0.35,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.1,0.15,0.7,0.05,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.35,0.25,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.1,0.7,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.05,0.1,0.85), 
             dim = c(4,4,4,4), dimnames = list(V = lv, T = lv, X = lv, Y = lv)); cptV

cptW = array(c(0.45, 0.25,0.1,0.2), dim = 4, dimnames = list(W = lv)); cptW

cptX = array(c(0.8,0.1,0.1,0.0,  0.2,0.7,0.1,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.2,0.8), 
             dim = c(4,4), dimnames = list(X = lv, U = lv)); cptX

cptY = array(c(0.55, 0.25,0.15,0.05), dim = 4, dimnames = list(Y = lv)); cptY

cptZ = array(c(0.15, 0.25,0.25,0.35), dim = 4, dimnames = list(Z = lv)); cptZ

net6 = model2network("[A][B][C|A][D|A:B][E|B][F][G|N][H|D][I|F:H][J][K|F:G:H][L][M][N][O|L:M:N][P][Q][R|Q][S][T|Q:S][U][V|T:X:Y][W][X|U][Y][Z]")
graphviz.plot(net6)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, F = cptF, G = cptG,
           H = cptH, I = cptI, J = cptJ, K = cptK, L = cptL, M = cptM, N = cptN,
           O = cptO, P = cptP, Q = cptQ, R = cptR, S = cptS, T = cptT, U = cptU,
           V = cptV, W = cptW, X = cptX, Y = cptY, Z = cptZ)
bn6 = custom.fit(net6, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                        "I", "J", "K", "L", "M", "N", "O", "P",
                                        "Q", "R", "S", "T", "U", "V", "W", "X", 
                                        "Y", "Z" ))
################################################################################

################################################################################
# DAG 7.

lv = c("1", "2", "3", "4")
cptA = array(c(0.5, 0.2,0.1,0.2), dim = 4, dimnames = list(A = lv));cptA

cptB = array(c(0.1, 0.2,0.1,0.6), dim = 4, dimnames = list(B = lv));cptB

cptC = array(c(0.9,0.1,0.0,0.0,  0.2,0.8,0.0,0.0,  0.0,0.1,0.8,0.1,  0.0,0.0,0.1,0.9), 
             dim = c(4,4), dimnames = list(C = lv, A = lv) ); cptC

cptD = array(c(0.7,0.2,0.1,0.0,  0.65,0.25,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.5,0.3,0.2,0.0,  0.75,0.15,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.2,0.1,  0.1,0.35,0.35,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.3,0.5,  
               0.1,0.4,0.4,0.1,  0.1,0.0,0.75,0.15,  0.0,0.1,0.5,0.4,  0.0,0.0,0.3,0.7), 
             dim = c(4, 4, 4),
             dimnames = list(D = lv, A = lv, B = lv) ); cptD

cptE = array(c(0.7,0.2,0.1,0.0,  0.4,0.5,0.1,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.4,0.6), 
             dim = c(4,4), dimnames = list(E = lv, B = lv)); cptE

cptF = array(c(0.1, 0.6,0.25,0.05), dim = 4, dimnames = list(F = lv)); cptF

cptG = array(c(0.9,0.05,0.05,0.0,  0.8,0.1,0.1,0.0,  0.2,0.3,0.4,0.1,  0.0,0.0,0.05,0.95), 
             dim = c(4,4), dimnames = list(G = lv, N = lv)); cptG

cptH = array(c(0.4, 0.3,0.2,0.1), dim = 4, dimnames = list(H = lv)); cptH

cptI = array(c(0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,
               0.65,0.3,0.05,0.0,  0.8,0.1,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.5,0.4,  0.0,0.0,0.1,0.9),
             dim = c(4,4,4), dimnames = list(I = lv, F = lv, H = lv)); cptI

cptJ = array(c(0.25, 0.35,0.15,0.25), dim = 4, dimnames = list(J = lv)); cptJ

cptK = array(c(0.7,0.2,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,
               0.75,0.2,0.05,0.0,  0.6,0.3,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.3,0.4,0.2,  0.0,0.2,0.7,0.1,  0.0,0.2,0.5,0.3,
               0.1,0.3,0.5,0.1,  0.1,0.0,0.6,0.3,  0.0,0.1,0.5,0.4,  0.0,0.0,0.2,0.8),
             dim = c(4,4,4), dimnames = list(K = lv, F = lv, H = lv)); cptK

cptL = array(c(0.25, 0.45,0.15,0.15), dim = 4, dimnames = list(L = lv)); cptL

cptM = array(c(0.15, 0.25,0.35,0.25), dim = 4, dimnames = list(M = lv)); cptM

cptN = array(c(0.1, 0.2,0.5,0.2), dim = 4, dimnames = list(N = lv)); cptN

cptO = array(c(0.95,0.05,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.9,0.1,0.0,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.55,0.35,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.3,0.55,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.3,0.3,0.1,  0.2,0.45,0.35,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.1,0.15,0.7,0.05,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.35,0.25,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.1,0.7,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.05,0.1,0.85), 
             dim = c(4,4,4,4), dimnames = list(O = lv, L = lv, M = lv, N = lv)); cptO

cptP = array(c(0.15, 0.35,0.35,0.15), dim = 4, dimnames = list(P = lv)); cptP

cptQ = array(c(0.05, 0.25,0.45,0.25), dim = 4, dimnames = list(Q = lv)); cptQ

cptR = array(c(0.6,0.3,0.1,0.0,  0.5,0.5,0.0,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.2,0.8), 
             dim = c(4,4), dimnames = list(R = lv, Q = lv)); cptR

cptS = array(c(0.55, 0.25,0.15,0.05), dim = 4, dimnames = list(S = lv)); cptS

cptT = array(c(0.8,0.1,0.1,0.0,  0.3,0.6,0.1,0.0,  0.3,0.2,0.4,0.1,  0.2,0.2,0.4,0.2,
               0.75,0.2,0.05,0.0,  0.3,0.6,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.1,0.8,0.1,  0.0,0.2,0.4,0.4,
               0.1,0.4,0.4,0.1,  0.1,0.0,0.8,0.1,  0.0,0.1,0.3,0.6,  0.0,0.0,0.05,0.95),
             dim = c(4,4,4), dimnames = list(T = lv, Q = lv, S = lv)); cptT

cptU = array(c(0.35, 0.25,0.3,0.1), dim = 4, dimnames = list(U = lv)); cptU

cptV = array(c(0.95,0.05,0.0,0.0,  0.8,0.1,0.1,0.0,  0.6,0.3,0.05,0.05,  0.4,0.3,0.2,0.1,  
               0.9,0.1,0.0,0.0,  0.7,0.15,0.15,0.0,  0.4,0.4,0.15,0.05,  0.3,0.3,0.2,0.2,
               0.55,0.35,0.1,0.0,  0.4,0.4,0.1,0.1,  0.2,0.6,0.1,0.1,  0.1,0.2,0.4,0.3,  
               0.4,0.4,0.1,0.1,   0.35,0.5,0.1,0.05,  0.2,0.3,0.3,0.2,  0.15,0.2,0.3,0.35,
               0.8,0.1,0.1,0.0,  0.7,0.2,0.1,0.0,  0.3,0.4,0.2,0.1,  0.2,0.2,0.4,0.2,  
               0.3,0.55,0.1,0.05,  0.1,0.8,0.1,0.0,  0.1,0.3,0.5,0.1,  0.1,0.3,0.4,0.2,
               0.2,0.5,0.25,0.05,  0.1,0.4,0.3,0.2,  0.0,0.3,0.6,0.1,  0.0,0.2,0.4,0.4,  
               0.1,0.4,0.4,0.1,  0.1,0.35,0.3,0.25,  0.0,0.1,0.5,0.4,  0.0,0.1,0.7,0.2,
               0.5,0.3,0.2,0.0,  0.3,0.6,0.1,0.0,  0.2,0.2,0.5,0.1,  0.15,0.2,0.4,0.25,  
               0.3,0.3,0.3,0.1,  0.2,0.45,0.35,0.0,  0.2,0.15,0.55,0.1,  0.1,0.3,0.4,0.2,
               0.1,0.15,0.7,0.05,  0.1,0.3,0.5,0.1,  0.0,0.2,0.75,0.05,  0.0,0.2,0.6,0.2,  
               0.2,0.1,0.4,0.3,   0.05,0.2,0.4,0.35,  0.1,0.1,0.7,0.1,  0.05,0.1,0.3,0.55,
               0.5,0.2,0.1,0.2,  0.35,0.25,0.1,0.3,  0.2,0.1,0.4,0.3,  0.2,0.1,0.2,0.5,  
               0.25,0.25,0.1,0.4,  0.1,0.5,0.2,0.2,  0.1,0.3,0.4,0.2,  0.0,0.3,0.2,0.5,
               0.2,0.15,0.35,0.3,  0.1,0.4,0.3,0.2,  0.0,0.2,0.6,0.2,  0.0,0.2,0.1,0.7,  
               0.2,0.0,0.15,0.65,  0.1,0.25,0.2,0.45,  0.0,0.1,0.3,0.6,  0.0,0.05,0.1,0.85), 
             dim = c(4,4,4,4), dimnames = list(V = lv, T = lv, X = lv, Y = lv)); cptV

cptW = array(c(0.8,0.1,0.1,0.0,  0.2,0.7,0.1,0.0,  0.1,0.3,0.5,0.1,  0.0,0.0,0.2,0.8), 
             dim = c(4,4), dimnames = list(W = lv, U = lv)); cptW

cptX = array(c(0.45, 0.25,0.1,0.2), dim = 4, dimnames = list(X = lv)); cptX

cptY = array(c(0.55, 0.25,0.15,0.05), dim = 4, dimnames = list(Y = lv)); cptY

cptZ = array(c(0.15, 0.25,0.25,0.35), dim = 4, dimnames = list(Z = lv)); cptZ

net7 = model2network("[A][B][C|A][D|A:B][E|B][F][G|N][H][I|F:H][J][K|F:H][L][M][N][O|L:M:N][P][Q][R|Q][S][T|Q:S][U][V|T:X:Y][W|U][X][Y][Z]")
graphviz.plot(net7)

cpt = list(A = cptA, B = cptB, C = cptC, D = cptD, E = cptE, F = cptF, G = cptG,
           H = cptH, I = cptI, J = cptJ, K = cptK, L = cptL, M = cptM, N = cptN,
           O = cptO, P = cptP, Q = cptQ, R = cptR, S = cptS, T = cptT, U = cptU,
           V = cptV, W = cptW, X = cptX, Y = cptY, Z = cptZ)
bn7 = custom.fit(net7, cpt, ordinal = c("A", "B", "C", "D", "E", "F", "G", "H",
                                        "I", "J", "K", "L", "M", "N", "O", "P",
                                        "Q", "R", "S", "T", "U", "V", "W", "X", 
                                        "Y", "Z" ))
################################################################################
